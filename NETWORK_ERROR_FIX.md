# 网络错误修复指南

## 🚨 常见错误：network error

### 错误现象
- 控制台显示：`TypeError: network error`
- API调用失败
- AI生成功能无法使用

---

## ✅ 快速修复步骤

### 步骤1：诊断问题
```
访问：http://localhost:5000/network-diagnostics
点击："开始诊断"按钮
```

这会自动测试：
- ✓ 浏览器网络连接
- ✓ 本地服务器连接
- ✓ API路由健康检查
- ✓ LLM服务连接
- ✓ localStorage读写

### 步骤2：根据诊断结果修复

#### 情况A：浏览器网络连接失败
**解决方案**：
1. 检查网络连接是否正常
2. 尝试访问其他网站（如百度、谷歌）
3. 如果其他网站也无法访问：
   - 检查网线或Wi-Fi连接
   - 重启路由器
   - 联系网络服务商
4. 如果使用代理或VPN，尝试关闭

#### 情况B：本地服务器连接失败
**解决方案**：
1. 刷新页面
2. 检查地址是否正确（应为 http://localhost:5000）
3. 检查服务器是否运行：
   ```bash
   # 在终端运行
   curl http://localhost:5000
   ```
4. 如果服务器未运行，重启服务：
   ```bash
   coze dev
   ```

#### 情况C：API路由健康检查失败
**解决方案**：
1. 刷新页面
2. 检查浏览器控制台是否有错误（F12）
3. 清除浏览器缓存：
   - Chrome: Ctrl+Shift+Delete
   - Mac: Cmd+Shift+Delete
4. 尝试无痕模式打开应用
5. 如果问题持续，重启浏览器

#### 情况D：LLM服务连接失败
**解决方案**：
1. **等待重试**：LLM服务可能暂时不可用，等待1-2分钟后重试
2. **减少内容**：如果生成的内容过长，尝试分段生成
3. **检查配置**：确保API配置正确
4. **查看日志**：检查服务器日志是否有错误信息
5. **联系支持**：如果问题持续，联系技术支持

---

## 🔧 手动修复方法

### 方法1：强制刷新
```
Windows: Ctrl + F5
Mac: Cmd + Shift + R
```

### 方法2：清除浏览器缓存
```
Chrome/Edge:
1. 按 F12 打开开发者工具
2. 右键点击刷新按钮
3. 选择"清空缓存并硬性重新加载"
```

### 方法3：重启浏览器
```
1. 关闭所有浏览器标签
2. 完全退出浏览器
3. 重新打开浏览器
4. 访问应用
```

### 方法4：重启服务器
```bash
# 如果使用coze cli
coze dev

# 如果使用其他方式
# 停止当前服务器（Ctrl+C）
# 重新启动服务器
```

---

## 📊 检查数据是否丢失

### 访问数据管理页面
```
http://localhost:5000/data-manager
```

### 查看数据状态
- ✓ localStorage使用率
- ✓ 快照数量
- ✓ 最后保存时间
- ✓ 数据内容概览

### 如果数据丢失
1. 点击"导出所有数据"查看是否有备份
2. 从最新快照恢复数据
3. 查看本地备份文件（如果有导出过）

---

## 🛡️ 预防措施

### 1. 定期备份
- 每天结束写作前，导出数据备份
- 保存备份文件到本地

### 2. 监控性能
```
访问：http://localhost:5000/performance-monitor
定期检查各项指标
```

### 3. 定期清理
- 每周清理一次旧快照
- 清理浏览器缓存（每月一次）

### 4. 稳定网络
- 使用稳定的网络连接
- 避免在网络不稳定时进行重要操作

---

## 🆘 仍然无法解决？

### 收集信息
1. 截图网络诊断页面
2. 记录错误详情（F12 > Console）
3. 记录错误发生时的操作
4. 记录浏览器版本和系统版本

### 联系支持
- 提供完整的错误信息
- 附上相关截图
- 说明已经尝试的解决方法

---

## 💡 常见问题

### Q1: 为什么会出现网络错误？
A: 可能原因包括：
- 网络连接不稳定
- LLM服务暂时不可用
- 浏览器缓存问题
- 服务器响应超时

### Q2: 网络错误会导致数据丢失吗？
A: 不会！应用使用数据保护器，所有数据都有备份：
- localStorage自动保存
- 最多保留10个快照
- 可以随时导出备份

### Q3: 如何避免网络错误？
A: 预防措施：
- 使用稳定的网络连接
- 定期备份数据
- 监控性能指标
- 定期清理缓存

### Q4: 出现网络错误后，我的数据还在吗？
A: 数据完全安全！
- 所有操作都会自动保存到localStorage
- 可以从快照恢复任何版本
- 导出的备份文件也是安全的

---

## 📞 快速参考

| 页面 | 地址 | 用途 |
|------|------|------|
| 网络诊断 | /network-diagnostics | 诊断网络问题 |
| 性能监控 | /performance-monitor | 查看性能状态 |
| 数据管理 | /data-manager | 备份和恢复数据 |
| 自动恢复 | /auto-recover.html | 自动找回数据 |
| 错误页面 | /error | 查看错误详情 |

---

记住：**网络错误通常不影响数据安全**，只需要耐心等待或按照上述步骤修复即可！
